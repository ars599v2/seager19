# usage: sh ./run-model

# STEP 1 -  spinup the dynamics - ignore the sst equation and use climo windstress

echo "A: $(date)" >> timing.txt

../SRC/tcom -i om_spin -t spin.tios 

echo "B: $(date)" >> timing.txt

../SRC/tios2cdf -f output/om_spin # cannot open data file: <output/om_spin.indx>

echo "C: $(date)" >> timing.txt

rm -rf output/om_spin.data output/om_spin.indx
cp -f output/om_spin.save output/om_spin.20y.restart

echo "D: $(date)" >> timing.txt

# STEP 2 -  diagnose the qflux needed to reproduce sst climatology
../SRC/tcom -i om_diag -t diag.tios

echo "E: $(date)" >> timing.txt

../SRC/tios2cdf -f output/om_diag

echo "F: $(date)" >> timing.txt

rm -rf output/om_diag.data output/om_diag.indx
cp -f output/om_diag.save output/om_diag.2y.restart

# if you have ingrid installed, do the next line,
# otherwise take the last year of qfluxes from om_diag.nc and 
# pop it into DATA/qflx.nc with your favorite tool
# /usr/local/bin/ingrid qflx.ing


# STEP 3 -  run the dynamics + sst in full mode

echo "G: $(date)" >> timing.txt

../SRC/tcom -i om_run2f -t month.tios 

echo "H: $(date)" >> timing.txt

../SRC/tios2cdf -f output/om_run2f

echo "I: $(date)" >> timing.txt

rm -rf output/om_run2f.data output/om_run2f.indx

